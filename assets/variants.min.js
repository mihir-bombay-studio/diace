class VariantSelects extends HTMLElement{constructor(){super();this.addEventListener("change",this.onVariantChange)}onVariantChange(){this.updateOptions();this.updateMasterId();this.toggleAddButton(!0,"",!1);this.updatePickupAvailability();this.currentVariant?(this.updateMedia(),this.updateURL(),this.updateVariantInput(),this.renderProductInfo()):(this.toggleAddButton(!0,"",!0),this.setUnavailable())}updateOptions(){this.options=Array.from(this.querySelectorAll("select"),a=>a.value)}updateMasterId(){this.currentVariant=
this.getVariantData().find(a=>!a.options.map((b,c)=>this.options[c]===b).includes(!1))}updateMedia(){if(this.currentVariant&&this.currentVariant?.featured_media){var a=document.querySelector(`[data-media-id="${this.dataset.section}-${this.currentVariant.featured_media.id}"]`);if(a){var b=a.parentElement;b.prepend(a);window.setTimeout(()=>{b.scroll(0,0)})}}}updateURL(){this.currentVariant&&($(".product-block-wrapper").hasClass("wrap-group")||window.history.replaceState({},"",`${this.dataset.url}?variant=${this.currentVariant.id}`))}updateVariantInput(){$(".product-qty-add-to-cart-wrapper #add-to-cart").attr("data-variant-id",
`${this.currentVariant.id}`);document.querySelectorAll(`#product-form-${this.dataset.section}, #product-form-installment`).forEach(a=>{a=a.querySelector('input[name="id"]');a.value=this.currentVariant.id;a.dispatchEvent(new Event("change",{bubbles:!0}))})}updatePickupAvailability(){const a=document.querySelector("pickup-availability");a&&(this.currentVariant?.available?a.fetchAvailability(this.currentVariant.id):(a.removeAttribute("available"),a.innerHTML=""))}renderProductInfo(){fetch(`${this.dataset.url}?variant=${this.currentVariant.id}&section_id=${this.dataset.section}`).then(a=>
a.text()).then(a=>{var b=`price-${this.dataset.section}`;const c=(new DOMParser).parseFromString(a,"text/html");a=document.getElementById(b);(b=c.getElementById(b))&&a&&(a.innerHTML=b.innerHTML);document.getElementById(`price-${this.dataset.section}`)?.classList.remove("visibility-hidden");this.toggleAddButton(!this.currentVariant.available,window.variantStrings.soldOut)})}toggleAddButton(a=!0,b,c){if(c=document.getElementById(`product-form-${this.dataset.section}`)?.querySelector('[name="add"]'))a?
(c.setAttribute("disabled",!0),b&&(c.textContent=b)):(c.removeAttribute("disabled"),c.textContent=window.variantStrings.addToCart)}setUnavailable(){const a=document.getElementById(`product-form-${this.dataset.section}`)?.querySelector('[name="add"]');a&&(a.textContent=window.variantStrings.unavailable,document.getElementById(`price-${this.dataset.section}`)?.classList.add("visibility-hidden"))}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.querySelector('[type="application/json"]').textContent)}}
customElements.define("variant-selects",VariantSelects);class VariantRadios extends VariantSelects{constructor(){super()}updateOptions(){this.options=Array.from(this.querySelectorAll("fieldset")).map(a=>Array.from(a.querySelectorAll("input")).find(b=>b.checked).value)}}customElements.define("variant-radios",VariantRadios);
