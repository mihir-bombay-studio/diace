  {% render 'ZooomyMoreLikeThis' %}
{{ 'featured-collection-new.css' | asset_url | stylesheet_tag }}
{% comment %}
{% assign product_handle = section.settings.featured_collection %} 
{% endcomment %}
<div class="featured-collection-wrapper container {{ section.settings.marg_top }}" >
  <h2 class="featured-collection-heading yellow-text bold">{{ section.settings.featured_collection_title }}</h2>
  {% for collection in product.collections limit:1%}
  {% assign product_handle = collection.handle %}
  {% endfor %}
  <div class="featured-collection-desc semibold">{{ section.settings.featured_collection_desc }}</div>

  <div class="featured-products flex-box">
    {% assign products_by_price_1 = collections[product_handle].products | sort: "price" %}
    {% if products_by_price_1.size > 1 %}
    {% assign products_by_price = collections[product_handle].products | sort: "price" %}
    {% else %}
    {% assign product_handle = section.settings.new_featured_collection %}
    {% assign products_by_price = collections[product_handle].products %} 
    {% endif %}
    {% assign current_id = product.id %}
    {% assign products_shown = 0 %}
    {% for product in products_by_price limit:4 %}
    {% if products_shown < 3 %}
    {% if product.id != current_id %}
    <div class="featured-product-card">
      <div class="featured-product-img rel">
        <a href="{{product.url}}"><img class="product-img" src="{{ product.featured_image.src | img_url: 'x282' }}"></a>
        <div class="AddToCart fp-hover-text flex-box align-center" data-variant-id="{{product.first_available_variant.id}}" data-quantity = "1">
          <span class="plus-icon">{% include 'icon-yellow-plus' %}</span>
          <a href="{{product.url}}" class="hover-text bold">{{ section.settings.hover_text }}</a>
        </div>
      </div>
      <div class="product-title-price flex-box justify-between">
        <div class="product-title semibold"><a href="{{product.url}}">{{ product.title | escape  }}</a></div>
        <div class="product-compare-to-and-price">
          {% if product.compare_at_price %}<span class="compare-to-price light">{{ product.compare_at_price | money }}</span>{% endif %}
          <span class="product-price semibold{% if product.compare_at_price %} yellow-text{% endif %}">{{ product.price | money }}</span>
        </div>
      </div>
      
      <div class="product-colors flex-box justify-between light">
        {% if product.has_only_default_variant %}   
        <div class="product-color">

        </div>          
        {% else %}
          {% for variant in product.variants limit: 1 %}
            {%- for option in product.options_with_values limit: 1 -%}
            <div class="product-color">
              <span>{{option.name}}: </span>
              <span>
                {{variant.title}}
              </span>
            </div>
            {% endfor %}
          {% endfor %}
          <div class="other-available-colors">
            <a class="featured-product-link" href="{{product.url}}">{{ section.settings.more_colors_text }}</a>
          </div>
        {% endif %}
      </div>
    </div>
    {% assign products_shown = products_shown | plus: 1 %}
    {% endif %}
    {% endif %}
    {% endfor %}
  </div>

  {% for block in section.blocks %}
  {% if block.type == "button" %}
  {%- if block.settings.button_label != blank -%}
  <a href="{{ block.settings.button_link }}" class="btn center-it {% if block.settings.button-color == 'grey' %}btn-grey{% else %}btn-yellow{% endif %}">{{ block.settings.button_label | escape }}</a>
  {%- endif -%}
  {% endif %}
  {% endfor %}
</div>
 
{% schema %}
  {
    "name": "Related Products",
    "settings": [
		{
          "type": "text",
          "id": "featured_collection_title",
          "label": "Featured Collection Title"
        },
		{
          "type": "text",
          "id": "featured_collection_desc",
          "label": "Featured Collection Desc"
        },
		{
          "type": "collection",
          "id": "new_featured_collection",
          "label": "Featured Collection"
        },
		{
			"type": "text",
			"id": "hover_text",
			"label": "Hover Text",
			"default": "KOPEN"
		},
		{
			"type": "text",
			"id": "more_colors_text",
			"label": "More Colours Text",
			"default": "Meer kleuren beschikbaar"
		},
		{
            "type": "select",
            "id": "marg_top",
            "label": "Margin Top",
            "options": [
              {
                "value": "big",
                "label": "Big"
              },
              {
                "value": "medium",
                "label": "Medium"
              }
            ],
            "default": "medium"
          }
	],
	"blocks": [
	{
          "type": "button",
          "name": "Button",
          "limit": 1,
          "settings": [
            {
              "type": "text",
              "id": "button_label",
              "default": "Button label",
              "label": "t:sections.image-with-text.blocks.button.settings.button_label.label",
              "info": "t:sections.image-with-text.blocks.button.settings.button_label.info"
            },
            {
              "type": "url",
              "id": "button_link",
              "label": "t:sections.image-with-text.blocks.button.settings.button_link.label"
            },
            {
              "type": "select",
              "id": "button-color",
              "options": [
                {
                  "value": "grey",
                  "label": "Grey"
                },
                {
                  "value": "yellow",
                  "label": "Yellow"
                }
              ],
              "default": "grey",
              "label": "Grey"
            }
          ]
        }
  ],
  "presets": [
    {
      "name": "Related Products",
		"category":"section"
    }
  ]
  }
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
{% endjavascript %}
